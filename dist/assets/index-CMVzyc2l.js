(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const _ of r)if(_.type==="childList")for(const c of _.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const _={};return r.integrity&&(_.integrity=r.integrity),r.referrerPolicy&&(_.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?_.credentials="include":r.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function o(r){if(r.ep)return;r.ep=!0;const _=n(r);fetch(r.href,_)}})();var Q,w,Ge,B,ve,Fe,Re,We,ue,le,ce,F={},qe=[],nt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ee=Array.isArray;function N(e,t){for(var n in t)e[n]=t[n];return e}function fe(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ot(e,t,n){var o,r,_,c={};for(_ in t)_=="key"?o=t[_]:_=="ref"?r=t[_]:c[_]=t[_];if(arguments.length>2&&(c.children=arguments.length>3?Q.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(_ in e.defaultProps)c[_]===void 0&&(c[_]=e.defaultProps[_]);return j(e,c,o,r,null)}function j(e,t,n,o,r){var _={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Ge,__i:-1,__u:0};return r==null&&w.vnode!=null&&w.vnode(_),_}function te(e){return e.children}function K(e,t){this.props=e,this.context=t}function O(e,t){if(t==null)return e.__?O(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?O(e):null}function ze(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return ze(e)}}function ge(e){(!e.__d&&(e.__d=!0)&&B.push(e)&&!X.__r++||ve!=w.debounceRendering)&&((ve=w.debounceRendering)||Fe)(X)}function X(){for(var e,t,n,o,r,_,c,a=1;B.length;)B.length>a&&B.sort(Re),e=B.shift(),a=B.length,e.__d&&(n=void 0,o=void 0,r=(o=(t=e).__v).__e,_=[],c=[],t.__P&&((n=N({},o)).__v=o.__v+1,w.vnode&&w.vnode(n),de(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[r]:null,_,r??O(o),!!(32&o.__u),c),n.__v=o.__v,n.__.__k[n.__i]=n,Ve(_,n,c),o.__e=o.__=null,n.__e!=r&&ze(n)));X.__r=0}function je(e,t,n,o,r,_,c,a,d,s,u){var l,h,i,v,y,m,p,g=o&&o.__k||qe,S=t.length;for(d=rt(n,t,g,d,S),l=0;l<S;l++)(i=n.__k[l])!=null&&(h=i.__i==-1?F:g[i.__i]||F,i.__i=l,m=de(e,i,h,r,_,c,a,d,s,u),v=i.__e,i.ref&&h.ref!=i.ref&&(h.ref&&he(h.ref,null,i),u.push(i.ref,i.__c||v,i)),y==null&&v!=null&&(y=v),(p=!!(4&i.__u))||h.__k===i.__k?d=Ke(i,d,e,p):typeof i.type=="function"&&m!==void 0?d=m:v&&(d=v.nextSibling),i.__u&=-7);return n.__e=y,d}function rt(e,t,n,o,r){var _,c,a,d,s,u=n.length,l=u,h=0;for(e.__k=new Array(r),_=0;_<r;_++)(c=t[_])!=null&&typeof c!="boolean"&&typeof c!="function"?(d=_+h,(c=e.__k[_]=typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?j(null,c,null,null,null):ee(c)?j(te,{children:c},null,null,null):c.constructor==null&&c.__b>0?j(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):c).__=e,c.__b=e.__b+1,a=null,(s=c.__i=_t(c,n,d,l))!=-1&&(l--,(a=n[s])&&(a.__u|=2)),a==null||a.__v==null?(s==-1&&(r>u?h--:r<u&&h++),typeof c.type!="function"&&(c.__u|=4)):s!=d&&(s==d-1?h--:s==d+1?h++:(s>d?h--:h++,c.__u|=4))):e.__k[_]=null;if(l)for(_=0;_<u;_++)(a=n[_])!=null&&(2&a.__u)==0&&(a.__e==o&&(o=O(a)),Ye(a,a));return o}function Ke(e,t,n,o){var r,_;if(typeof e.type=="function"){for(r=e.__k,_=0;r&&_<r.length;_++)r[_]&&(r[_].__=e,t=Ke(r[_],t,n,o));return t}e.__e!=t&&(o&&(t&&e.type&&!t.parentNode&&(t=O(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function _t(e,t,n,o){var r,_,c,a=e.key,d=e.type,s=t[n],u=s!=null&&(2&s.__u)==0;if(s===null&&e.key==null||u&&a==s.key&&d==s.type)return n;if(o>(u?1:0)){for(r=n-1,_=n+1;r>=0||_<t.length;)if((s=t[c=r>=0?r--:_++])!=null&&(2&s.__u)==0&&a==s.key&&d==s.type)return c}return-1}function ye(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||nt.test(t)?n:n+"px"}function z(e,t,n,o,r){var _,c;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||ye(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||ye(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")_=t!=(t=t.replace(We,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+_]=n,n?o?n.u=o.u:(n.u=ue,e.addEventListener(t,_?ce:le,_)):e.removeEventListener(t,_?ce:le,_);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function we(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ue++;else if(t.t<n.u)return;return n(w.event?w.event(t):t)}}}function de(e,t,n,o,r,_,c,a,d,s){var u,l,h,i,v,y,m,p,g,S,T,C,$,I,U,H,D,x=t.type;if(t.constructor!=null)return null;128&n.__u&&(d=!!(32&n.__u),_=[a=t.__e=n.__e]),(u=w.__b)&&u(t);e:if(typeof x=="function")try{if(p=t.props,g="prototype"in x&&x.prototype.render,S=(u=x.contextType)&&o[u.__c],T=u?S?S.props.value:u.__:o,n.__c?m=(l=t.__c=n.__c).__=l.__E:(g?t.__c=l=new x(p,T):(t.__c=l=new K(p,T),l.constructor=x,l.render=ct),S&&S.sub(l),l.props=p,l.state||(l.state={}),l.context=T,l.__n=o,h=l.__d=!0,l.__h=[],l._sb=[]),g&&l.__s==null&&(l.__s=l.state),g&&x.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=N({},l.__s)),N(l.__s,x.getDerivedStateFromProps(p,l.__s))),i=l.props,v=l.state,l.__v=t,h)g&&x.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),g&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(g&&x.getDerivedStateFromProps==null&&p!==i&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(p,T),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(p,l.__s,T)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(l.props=p,l.state=l.__s,l.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(A){A&&(A.__=t)}),C=0;C<l._sb.length;C++)l.__h.push(l._sb[C]);l._sb=[],l.__h.length&&c.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(p,l.__s,T),g&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(i,v,y)})}if(l.context=T,l.props=p,l.__P=e,l.__e=!1,$=w.__r,I=0,g){for(l.state=l.__s,l.__d=!1,$&&$(t),u=l.render(l.props,l.state,l.context),U=0;U<l._sb.length;U++)l.__h.push(l._sb[U]);l._sb=[]}else do l.__d=!1,$&&$(t),u=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++I<25);l.state=l.__s,l.getChildContext!=null&&(o=N(N({},o),l.getChildContext())),g&&!h&&l.getSnapshotBeforeUpdate!=null&&(y=l.getSnapshotBeforeUpdate(i,v)),H=u,u!=null&&u.type===te&&u.key==null&&(H=Xe(u.props.children)),a=je(e,ee(H)?H:[H],t,n,o,r,_,c,a,d,s),l.base=t.__e,t.__u&=-161,l.__h.length&&c.push(l),m&&(l.__E=l.__=null)}catch(A){if(t.__v=null,d||_!=null)if(A.then){for(t.__u|=d?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;_[_.indexOf(a)]=null,t.__e=a}else{for(D=_.length;D--;)fe(_[D]);ie(t)}else t.__e=n.__e,t.__k=n.__k,A.then||ie(t);w.__e(A,t,n)}else _==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):a=t.__e=lt(n.__e,t,n,o,r,_,c,d,s);return(u=w.diffed)&&u(t),128&t.__u?void 0:a}function ie(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(ie)}function Ve(e,t,n){for(var o=0;o<n.length;o++)he(n[o],n[++o],n[++o]);w.__c&&w.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(_){_.call(r)})}catch(_){w.__e(_,r.__v)}})}function Xe(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:ee(e)?e.map(Xe):N({},e)}function lt(e,t,n,o,r,_,c,a,d){var s,u,l,h,i,v,y,m=n.props,p=t.props,g=t.type;if(g=="svg"?r="http://www.w3.org/2000/svg":g=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),_!=null){for(s=0;s<_.length;s++)if((i=_[s])&&"setAttribute"in i==!!g&&(g?i.localName==g:i.nodeType==3)){e=i,_[s]=null;break}}if(e==null){if(g==null)return document.createTextNode(p);e=document.createElementNS(r,g,p.is&&p),a&&(w.__m&&w.__m(t,_),a=!1),_=null}if(g==null)m===p||a&&e.data==p||(e.data=p);else{if(_=_&&Q.call(e.childNodes),m=n.props||F,!a&&_!=null)for(m={},s=0;s<e.attributes.length;s++)m[(i=e.attributes[s]).name]=i.value;for(s in m)if(i=m[s],s!="children"){if(s=="dangerouslySetInnerHTML")l=i;else if(!(s in p)){if(s=="value"&&"defaultValue"in p||s=="checked"&&"defaultChecked"in p)continue;z(e,s,null,i,r)}}for(s in p)i=p[s],s=="children"?h=i:s=="dangerouslySetInnerHTML"?u=i:s=="value"?v=i:s=="checked"?y=i:a&&typeof i!="function"||m[s]===i||z(e,s,i,m[s],r);if(u)a||l&&(u.__html==l.__html||u.__html==e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(l&&(e.innerHTML=""),je(t.type=="template"?e.content:e,ee(h)?h:[h],t,n,o,g=="foreignObject"?"http://www.w3.org/1999/xhtml":r,_,c,_?_[0]:n.__k&&O(n,0),a,d),_!=null)for(s=_.length;s--;)fe(_[s]);a||(s="value",g=="progress"&&v==null?e.removeAttribute("value"):v!=null&&(v!==e[s]||g=="progress"&&!v||g=="option"&&v!=m[s])&&z(e,s,v,m[s],r),s="checked",y!=null&&y!=e[s]&&z(e,s,y,m[s],r))}return e}function he(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(r){w.__e(r,n)}}function Ye(e,t,n){var o,r;if(w.unmount&&w.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||he(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(_){w.__e(_,t)}o.base=o.__P=null}if(o=e.__k)for(r=0;r<o.length;r++)o[r]&&Ye(o[r],t,n||typeof e.type!="function");n||fe(e.__e),e.__c=e.__=e.__e=void 0}function ct(e,t,n){return this.constructor(e,n)}function it(e,t,n){var o,r,_,c;t==document&&(t=document.documentElement),w.__&&w.__(e,t),r=(o=!1)?null:t.__k,_=[],c=[],de(t,e=t.__k=ot(te,null,[e]),r||F,F,t.namespaceURI,r?null:t.firstChild?Q.call(t.childNodes):null,_,r?r.__e:t.firstChild,o,c),Ve(_,e,c)}Q=qe.slice,w={__e:function(e,t,n,o){for(var r,_,c;t=t.__;)if((r=t.__c)&&!r.__)try{if((_=r.constructor)&&_.getDerivedStateFromError!=null&&(r.setState(_.getDerivedStateFromError(e)),c=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,o||{}),c=r.__d),c)return r.__E=r}catch(a){e=a}throw e}},Ge=0,K.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=N({},this.state),typeof e=="function"&&(e=e(N({},n),this.props)),e&&N(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),ge(this))},K.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ge(this))},K.prototype.render=te,B=[],Fe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Re=function(e,t){return e.__v.__b-t.__v.__b},X.__r=0,We=/(PointerCapture)$|Capture$/i,ue=0,le=we(!1),ce=we(!0);var st=0;function f(e,t,n,o,r,_){t||(t={});var c,a,d=t;if("ref"in d)for(a in d={},t)a=="ref"?c=t[a]:d[a]=t[a];var s={type:e,props:d,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--st,__i:-1,__u:0,__source:r,__self:_};if(typeof e=="function"&&(c=e.defaultProps))for(a in c)d[a]===void 0&&(d[a]=c[a]);return w.vnode&&w.vnode(s),s}var R,b,ne,be,Y=0,Ze=[],k=w,ke=k.__b,Se=k.__r,$e=k.diffed,xe=k.__c,Te=k.unmount,Ce=k.__;function pe(e,t){k.__h&&k.__h(b,e,Y||t),Y=0;var n=b.__H||(b.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function E(e){return Y=1,at(Qe,e)}function at(e,t,n){var o=pe(R++,2);if(o.t=e,!o.__c&&(o.__=[Qe(void 0,t),function(a){var d=o.__N?o.__N[0]:o.__[0],s=o.t(d,a);d!==s&&(o.__N=[s,o.__[1]],o.__c.setState({}))}],o.__c=b,!b.__f)){var r=function(a,d,s){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(h){return!!h.__c});if(u.every(function(h){return!h.__N}))return!_||_.call(this,a,d,s);var l=o.__c.props!==a;return u.forEach(function(h){if(h.__N){var i=h.__[0];h.__=h.__N,h.__N=void 0,i!==h.__[0]&&(l=!0)}}),_&&_.call(this,a,d,s)||l};b.__f=!0;var _=b.shouldComponentUpdate,c=b.componentWillUpdate;b.componentWillUpdate=function(a,d,s){if(this.__e){var u=_;_=void 0,r(a,d,s),_=u}c&&c.call(this,a,d,s)},b.shouldComponentUpdate=r}return o.__N||o.__}function G(e,t){var n=pe(R++,3);!k.__s&&Je(n.__H,t)&&(n.__=e,n.u=t,b.__H.__h.push(n))}function Z(e,t){var n=pe(R++,7);return Je(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function ut(e,t){return Y=8,Z(function(){return e},t)}function ft(){for(var e;e=Ze.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(V),e.__H.__h.forEach(se),e.__H.__h=[]}catch(t){e.__H.__h=[],k.__e(t,e.__v)}}k.__b=function(e){b=null,ke&&ke(e)},k.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ce&&Ce(e,t)},k.__r=function(e){Se&&Se(e),R=0;var t=(b=e.__c).__H;t&&(ne===b?(t.__h=[],b.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(V),t.__h.forEach(se),t.__h=[],R=0)),ne=b},k.diffed=function(e){$e&&$e(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ze.push(t)!==1&&be===k.requestAnimationFrame||((be=k.requestAnimationFrame)||dt)(ft)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ne=b=null},k.__c=function(e,t){t.some(function(n){try{n.__h.forEach(V),n.__h=n.__h.filter(function(o){return!o.__||se(o)})}catch(o){t.some(function(r){r.__h&&(r.__h=[])}),t=[],k.__e(o,n.__v)}}),xe&&xe(e,t)},k.unmount=function(e){Te&&Te(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{V(o)}catch(r){t=r}}),n.__H=void 0,t&&k.__e(t,n.__v))};var Ae=typeof requestAnimationFrame=="function";function dt(e){var t,n=function(){clearTimeout(o),Ae&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);Ae&&(t=requestAnimationFrame(n))}function V(e){var t=b,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),b=t}function se(e){var t=b;e.__c=e.__(),b=t}function Je(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function Qe(e,t){return typeof t=="function"?t(e):t}const Me="theme";function ht(){const e=typeof window<"u",t=e?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches:!1,[n,o]=E(()=>{const _=e?localStorage.getItem(Me):null;return _==="light"||_==="dark"?_:t?"dark":"light"});return G(()=>{document.documentElement.setAttribute("theme",n);try{localStorage.setItem(Me,n)}catch{}},[n]),{theme:n,toggle:()=>o(_=>_==="light"?"dark":"light")}}const pt="./sounds/slide.mp3",mt="./sounds/pop.mp3",Ee="sfxMuted";function vt(){const[e,t]=E(()=>{try{return localStorage.getItem(Ee)==="true"}catch{return!1}});G(()=>{try{localStorage.setItem(Ee,String(e))}catch{}},[e]);const n=()=>t(c=>!c),o=Z(()=>{const c=new Audio(pt);return c.volume=.55,c},[]),r=Z(()=>{const c=new Audio(mt);return c.volume=.25,c},[]);return{muted:e,toggle:n,move:o,merge:r,play:c=>{if(!e)try{c.currentTime=0,c.play()}catch{}}}}const Ne=({children:e})=>f("span",{class:"badge",children:e}),gt=({theme:e,onToggle:t})=>f("button",{class:"theme-toggle",onClick:t,children:e==="dark"?"Lighten up!":"Go dark!"}),yt=({muted:e,onToggle:t})=>f("button",{class:"sfx-toggle",onClick:t,children:e?"Unmute SFX":"Mute SFX"}),wt=({score:e,highScore:t,theme:n,onToggleTheme:o,sfxMuted:r,onToggleSfx:_})=>f("header",{class:"header",children:[f(Ne,{children:["Score: ",e]}),f(Ne,{children:["High Score: ",t]}),f(gt,{theme:n,onToggle:o}),f(yt,{muted:r,onToggle:_})]}),bt=({onClick:e})=>f("button",{class:"controls__new-game",onClick:e,children:"New Game"}),kt=({onClick:e,disabled:t})=>f("button",{class:"controls__undo",onClick:e,disabled:t,children:"Undo"}),St=({onMove:e,disabled:t})=>f("div",{class:"controls__moves",children:[f("button",{class:"btn",onClick:()=>e("up"),disabled:t,children:"↑"}),f("button",{class:"btn",onClick:()=>e("left"),disabled:t,children:"←"}),f("button",{class:"btn",onClick:()=>e("down"),disabled:t,children:"↓"}),f("button",{class:"btn",onClick:()=>e("right"),disabled:t,children:"→"})]}),$t=({onNewGame:e,onUndo:t,undoDisabled:n,onMove:o,gameOver:r=!1})=>f("div",{class:"controls",children:[f(bt,{onClick:e}),f(kt,{onClick:t,disabled:n}),f(St,{onMove:o,disabled:r})]}),xt=({value:e})=>{const t=e>0?String(e):"",n=e>2048?2048:e,o=e>0?`tile--v${n}`:"tile--empty";return f("div",{class:`tile ${o}`,children:t})},Tt=({width:e,height:t,children:n})=>f("div",{class:"board-frame",style:{width:`${e}px`,height:`${t}px`},children:n}),Ct=({size:e,gap:t})=>f("div",{class:"board-grid",style:{display:"grid",gap:`${t}px`,gridTemplateColumns:`repeat(${e}, 1fr)`,gridTemplateRows:`repeat(${e}, 1fr)`,width:"100%",height:"100%"},children:Array.from({length:e*e}).map((n,o)=>f("div",{class:"board-slot"},o))}),At=({children:e})=>f("div",{class:"tile-layer",children:e}),Mt=({left:e,top:t,size:n,dx:o,dy:r,transition:_,children:c})=>f("div",{class:"tile-sprite",style:{left:`${e}px`,top:`${t}px`,width:`${n}px`,height:`${n}px`,transform:`translate(${o}px, ${r}px)`,transition:_},children:c}),oe=340,re=10,L=10,Et=({board:e,animMoves:t,animMs:n=150})=>{const o=e.length,r=(oe-2*re-L*(o-1))/o,_=u=>re+u*(r+L),c=u=>re+u*(r+L),a=new Map;if(t)for(const u of t)a.set(`${u.from.row},${u.from.col}`,{toRow:u.to.row,toCol:u.to.col});const d=[];for(let u=0;u<o;u++)for(let l=0;l<o;l++){const h=e[u][l];if(h<=0)continue;const i=a.get(`${u},${l}`),v=i?i.toRow:u,m=((i?i.toCol:l)-l)*(r+L),p=(v-u)*(r+L);d.push({key:`${u}-${l}-${h}`,row:u,col:l,value:h,dx:m,dy:p})}const s=t?`transform ${n}ms ease`:"none";return f(Tt,{width:oe,height:oe,children:[f(Ct,{size:o,gap:L}),f(At,{children:d.map(u=>f(Mt,{left:_(u.col),top:c(u.row),size:r,dx:u.dx,dy:u.dy,transition:s,children:f(xt,{value:u.value})},u.key))})]})},Nt=3,Pt=6,Ht=({size:e,onChange:t})=>f("div",{class:"board-size",children:[f("span",{children:["Size: ",e]}),f("div",{class:"board-size__buttons",children:[f("button",{class:"board-size__btn",onClick:()=>t(e+1),disabled:e>=Pt,children:"+"}),f("button",{class:"board-size__btn",onClick:()=>t(e-1),disabled:e<=Nt,children:"–"})]})]}),Bt=({children:e})=>f("div",{class:"overlay",children:f("div",{class:"overlay__box",children:e})}),It=({score:e})=>f(Bt,{children:[f("div",{class:"overlay__title",children:"Game Over"}),f("div",{class:"overlay__score",children:["Score: ",e]})]}),Ut=({title:e="2048",size:t,onSizeChange:n,board:o,animMoves:r,animMs:_=150,gameOver:c,score:a})=>f("section",{class:"panel",children:[f("h2",{class:"board-panel__header",children:[f("span",{class:"board-panel__title",children:e}),f(Ht,{size:t,onChange:n})]}),f(Et,{board:o,animMoves:r,animMs:_}),c&&f(It,{score:a})]}),Lt={ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"};function W(e){return Array.from({length:e},()=>Array.from({length:e},()=>0))}function J(e){return e.map(t=>t.slice())}function Ot(e){const t=[];for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)e[n][o]===0&&t.push({row:n,col:o});return t}function Dt(){return Math.random()<.6?2:4}function ae(e){const t=Ot(e);if(t.length===0)return e;const{row:n,col:o}=t[Math.floor(Math.random()*t.length)],r=J(e);return r[n][o]=Dt(),r}function _e(e){let t=W(e);return t=ae(t),t=ae(t),t}function Gt(e){return e.flat().reduce((t,n)=>t+n,0)}function Ft(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)if(e[t][n]===0)return!0;return!1}function Rt(e){const t=e.length;for(let n=0;n<t;n++)for(let o=0;o<t;o++){const r=e[n][o];if(r!==0&&(o+1<t&&e[n][o+1]===r||n+1<t&&e[n+1][o]===r))return!0}return!1}function Pe(e){return Ft(e)||Rt(e)}function He(e){const t=e.length,n=W(t);for(let o=0;o<t;o++)for(let r=0;r<t;r++)n[t-1-r][o]=e[o][r];return n}function Be(e){const t=e.length,n=W(t);for(let o=0;o<t;o++)for(let r=0;r<t;r++)n[r][t-1-o]=e[o][r];return n}function Ie(e){return e.map(t=>t.slice().reverse())}function Wt(e,t){const n=e.length,o=i=>t==="up"?He(i):t==="down"?Be(i):t==="right"?Ie(i):J(i),r=i=>t==="up"?Be(i):t==="down"?He(i):t==="right"?Ie(i):J(i),_=o(e),c=W(n),a=[];let d=!1;for(let i=0;i<n;i++){const v=[];for(let m=0;m<n;m++){const p=_[i][m];p!==0&&v.push({c:m,v:p})}let y=0;for(let m=0;m<v.length;m++){const p=v[m];m+1<v.length&&p.v===v[m+1].v?(a.push({from:{row:i,col:p.c},to:{row:i,col:y},value:p.v}),a.push({from:{row:i,col:v[m+1].c},to:{row:i,col:y},value:v[m+1].v}),c[i][y]=p.v*2,m++,d=!0,y++):(a.push({from:{row:i,col:p.c},to:{row:i,col:y},value:p.v}),c[i][y]=p.v,y++)}}const s=r(c),u=(i,v)=>{const y=W(n);y[i][v]=1;const m=r(y);for(let p=0;p<n;p++)for(let g=0;g<n;g++)if(m[p][g]===1)return{row:p,col:g};return{row:i,col:v}},l=a.map(i=>({from:u(i.from.row,i.from.col),to:u(i.to.row,i.to.col),value:i.value})),h=!qt(e,s);return{next:s,moves:l,moved:h,merged:d}}function qt(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)if(e[n][o]!==t[n][o])return!1;return!0}function zt(){try{const e=localStorage.getItem("savedGameState");if(!e)return null;const t=JSON.parse(e);return!Array.isArray(t.board)||t.board.length===0?null:{board:t.board,prevBoard:t.prevBoard??null}}catch{return null}}function Ue(e,t){try{const n={board:e,prevBoard:t};localStorage.setItem("savedGameState",JSON.stringify(n))}catch{}}function jt(){try{localStorage.removeItem("savedGameState")}catch{}}const Le="highScore",Oe=150,Kt=4;function Vt(){const{theme:e,toggle:t}=ht(),{muted:n,toggle:o,move:r,merge:_,play:c}=vt(),a=zt(),d=a?a.board.length:Kt,s=a?.board??_e(d),[u,l]=E(d),[h,i]=E(s),[v,y]=E(a?.prevBoard??null),[m,p]=E(()=>!Pe(s)),[g,S]=E(!1),[T,C]=E(void 0),$=Z(()=>Gt(h),[h]),[I,U]=E(()=>{const M=typeof window<"u"?localStorage.getItem(Le):null;return M?Number(M):0});G(()=>{if($>I){U($);try{localStorage.setItem(Le,String($))}catch{}}},[$,I]);const H=M=>{const P=Math.min(Math.max(M,3),6);l(P);try{localStorage.setItem("boardSize",String(P))}catch{}i(_e(P)),y(null),p(!1),S(!1),C(void 0)},D=()=>{jt(),i(_e(u)),y(null),p(!1),S(!1),C(void 0)},x=()=>{v&&(i(v),y(null),p(!1),S(!1),C(void 0))},A=ut(M=>{if(m||g)return;const{next:P,moves:q,moved:et,merged:tt}=Wt(h,M);et&&(c(r),tt&&c(_),S(!0),C(q),window.setTimeout(()=>{y(J(h)),C(void 0),S(!1);const me=ae(P);i(me),Pe(me)||p(!0)},Oe))},[h,m,g,c,r,_]);return G(()=>{const M=P=>{const q=Lt[P.key];q&&(P.preventDefault(),A(q))};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[A]),G(()=>{m?Ue(h,null):Ue(h,v)},[h,v,m]),f("div",{class:"app",children:[f(wt,{score:$,highScore:I,theme:e,onToggleTheme:t,sfxMuted:n,onToggleSfx:o}),f("main",{class:"app_main",children:[f(Ut,{size:u,onSizeChange:H,board:h,animMoves:T,animMs:Oe,gameOver:m,score:$}),f("section",{class:"panel",children:[f("h2",{class:"panel_title",children:"Controls"}),f($t,{onNewGame:D,onUndo:x,undoDisabled:!v||m,onMove:A,gameOver:m})]})]})]})}const De=document.getElementById("app");De&&it(f(Vt,{}),De);
